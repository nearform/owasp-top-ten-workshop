import{_ as f}from"./CodeBlockWrapper-siMSE_gV.js";import{I as g}from"./default-DAWz1zwl.js";import{_ as m,bc as h}from"../index-DbjAHYTp.js";import{p as d,u as c,f as y}from"./context-MHM20Ows.js";import{o as A,c as C,k,e,l as v,m as x,q as $,s as b,a6 as s}from"../modules/vue-qLwg7mlj.js";import"../modules/unplugin-icons-cDJQvHvz.js";import"../modules/shiki-DvLM4DQx.js";const B={__name:"62",setup(p,{expose:a}){a(),d(h);const{$slidev:n,$nav:t,$clicksContext:r,$clicks:o,$page:i,$renderContext:u,$frontmatter:_}=c(),l={$slidev:n,$nav:t,$clicksContext:r,$clicks:o,$page:i,$renderContext:u,$frontmatter:_,InjectedLayout:g,get frontmatter(){return h},get useSlideContext(){return c},get _provideFrontmatter(){return d},get _frontmatterToProps(){return y}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}},D=e("h1",null,"A08 Exercise: Insecure Deserialization",-1),I={class:"dense"},P=e("ul",null,[e("li",null,[s("When decoding the cookie attached to the "),e("code",null,"/profile"),s(" request, this is what the output looks like:")])],-1),j=e("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[e("code",{class:"language-javascript"},[e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"// base64 to ASCII")]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"{")]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"  id"),e("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":"),e("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}}," 1"),e("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},",")]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"  username"),e("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":")]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#C98A7D99","--shiki-light":"#B5695999"}},'    "'),e("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},"_$$ND_FUNC$$_function () {"),e("span",{style:{"--shiki-dark":"#C99076","--shiki-light":"#A65E2B"}},"\\n"),e("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},"    throw new Error('server error')"),e("span",{style:{"--shiki-dark":"#C99076","--shiki-light":"#A65E2B"}},"\\n"),e("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},"  }()"),e("span",{style:{"--shiki-dark":"#C98A7D99","--shiki-light":"#B5695999"}},'"')]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"}")])])],-1),N=e("ul",null,[e("li",null,[s("Note that there is an "),e("code",null,"IIFE"),s(" at the end of the username key, and this causes the function to run on the server as it is doing an insecure deserialization")]),e("li",null,[s("The full step by step to serialize a JavaScript code and inject it as a cookie can be found "),e("a",{href:"https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/",target:"_blank"},"in this article")])],-1);function S(p,a,n,t,r,o){const i=f;return A(),C(t.InjectedLayout,$(b(t._frontmatterToProps(t.frontmatter,61))),{default:k(()=>[D,e("div",I,[P,v(i,x({},{ranges:[]}),{default:k(()=>[j]),_:1},16),N])]),_:1},16)}const L=m(B,[["render",S],["__file","/@slidev/slides/62.md"]]);export{L as default};
